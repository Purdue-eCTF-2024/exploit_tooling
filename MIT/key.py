# I think this is the key
# address 0x1001afac
# wrong
key = b"'\x01\xf8\x0c\x92b,E8\xc40Pz\xee0\x00\xd2c+-\xb0\xc1t\xdc\xf2\x0e\x90\xaf\x04\xc5\xa3\xbc"
print(len(key))

secret = key.hex()
print(secret)
key_c_str  = "".join(["\\x" +  secret[i:i+2] for i in range(0,  len(secret), 2)])

print(key_c_str)

from pwn import *

# potential code of mit_encrypt
code = b'-\xe9\xf0O%L\x05F\x0eF\x85\xb0A\x1c\x05\xf1\x13\x07#0\xaeF\x05\xf1\x0c\x0c\xa2F\xa8FO\xf0\x00\t\x18\xf8\x01\xbf\x1a\xf8\x01;\xe0E\x83\xea\x0b\x03I\xea\x03\t\xf5\xd1\xb9\xf1\x00\x0f,\xd0\xdf\xf8\\\xa0\xa8FO\xf0\x00\t\x18\xf8\x01\xbf\x1a\xf8\x01;\xe0E\x83\xea\x0b\x03I\xea\x03\t\xf5\xd1\xb9\xf1\x00\x0f\x1a\xd0O\xf0\x00\x08\x1e\xf8\x01\x9f\x14\xf8\x01;\xe6E\x83\xea\t\x03H\xea\x03\x08\xf5\xd1\xb8\xf1\x00\x0f\x0b\xd0\xcd\xe9\x02\x07\xcd\xe9\x00b\x06H\x13#*F\x00\xf04\xfd\x05\xb0\xbd\xe8\xf0\x8fO\xf0\xff0\xf9\xe7\x1c\x08\x00 '
print(disasm(code, arch='thumb'))

ld_addr = 0x1000e34e + 0x24
print(hex(ld_addr))

# new address: 0x1001afac

